---
openapi: 3.0.1
info:
  title: API V1
  version: v1
paths:
  "/api/v1/conversions":
    parameters:
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: List conversions
      operationId: getConversions
      description: List conversion tasks for user
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
              - id: 82d200b4-a48c-4a46-8a53-23b06690e1e5
                space_id: a84c6501-72e1-4c13-a647-805cbbff0eb7
                space_key: siTmHBwx
                status: inProgress
                progress: '0.0'
                start_time: 2024-06-02 12:31:36 UTC
                end_time: 
                conversion_job_id: f6f10c3e-753e-4f30-ba26-a6e85f2e9e08
                created_at: 2024-06-02 12:31:36 UTC
                updated_at: 2024-06-02 12:31:36 UTC
                meta:
                  dest_resource_id: 1fc38ed6-abac-456e-91c8-d2dd80b331fc
                  dest_version_id: e3f7d4d1-5ee5-42ef-b884-e1357addb246
              - id: a55f3b76-9a20-412c-8c15-42991b541b77
                space_id: a84c6501-72e1-4c13-a647-805cbbff0eb7
                space_key: siTmHBwx
                status: inProgress
                progress: '0.0'
                start_time: 2024-06-02 12:31:36 UTC
                end_time: 
                conversion_job_id: e8ab6c6f-45ea-420b-b75b-abd6ade54871
                created_at: 2024-06-02 12:31:36 UTC
                updated_at: 2024-06-02 12:31:36 UTC
                meta:
                  dest_resource_id: b08650f4-53b6-42ad-9ca8-a4ca8b7ea7fd
                  dest_version_id: bb010fb6-1be0-4b94-8fda-cfdb8485aaf9
              - id: ea16f197-e1fb-4219-833c-8dddba8d6b59
                space_id: a84c6501-72e1-4c13-a647-805cbbff0eb7
                space_key: siTmHBwx
                status: inProgress
                progress: '0.0'
                start_time: 2024-06-02 12:31:36 UTC
                end_time: 
                conversion_job_id: cd54a00f-dbda-4108-a750-c834414c22a3
                created_at: 2024-06-02 12:31:36 UTC
                updated_at: 2024-06-02 12:31:36 UTC
                meta:
                  dest_resource_id: 99f744f4-5295-492f-b253-c328e2be636c
                  dest_version_id: 519d2976-f282-412b-bcf6-5d7705f8bac1
              schema:
                type: array
                items:
                  "$ref": "#/components/schemas/conversion_task"
  "/api/v1/conversions/{id}":
    parameters:
    - name: id
      in: path
      description: id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: show conversion
      operationId: getConversion
      description: Get description of Conversion Task
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: 588e6d4c-896b-431f-ab74-0a58ad665646
                space_id: 5b2e5b20-87a7-4c60-8ca9-346362e0642e
                space_key: K4GbTmsh
                status: inProgress
                progress: '0.0'
                start_time: 2024-06-02 12:31:36 UTC
                end_time: 
                conversion_job_id: 96c5daaa-b750-4f6f-ac0a-194fb091020a
                created_at: 2024-06-02 12:31:36 UTC
                updated_at: 2024-06-02 12:31:36 UTC
                meta:
                  dest_resource_id: 3ad7fe4c-9375-4459-bdbe-6150c9aa2dce
                  dest_version_id: '0728856b-bf78-45da-8e23-3d51be718f93'
              schema:
                "$ref": "#/components/schemas/conversion_task"
  "/api/v1/conversions/{id}/logs":
    parameters:
    - name: id
      in: path
      description: Conversion Task id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: logs conversion
      operationId: getConversionLogs
      description: Get logs of Conversion Task (redirect to logs file)
      responses:
        '302':
          description: successful
  "/api/v1/op/convert-anonym":
    post:
      summary: convert_anonym op
      operationId: convertAnonym
      description: Start anonym conversion
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: 8ecd8c08-6da5-4a46-a40d-141816db61d9
                space_id: b2961d72-aca1-4f4d-8335-00762d69fd0c
                space_key: uPuf4ln1
                status: inProgress
                progress: '0.0'
                start_time: 2024-06-02 12:31:36 UTC
                end_time: 
                conversion_job_id: cb53fbee-0f71-4116-b26d-71f1793c47fc
                created_at: 2024-06-02 12:31:36 UTC
                updated_at: 2024-06-02 12:31:36 UTC
                meta:
                  dest_resource_id: 0c1ecdd5-69ec-464a-b0aa-b0c0daa71cfd
                  dest_version_id: 46f52144-ba65-49cb-9941-a3cb73671795
              schema:
                "$ref": "#/components/schemas/conversion_task"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - input_file
              properties:
                input_file:
                  type: string
                  description: Active Storage signeID
  "/users":
    post:
      summary: create registration
      operationId: signUp
      description: Sign up new user
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                user:
                  id: 6cbb2779-47c5-4e4d-b97e-2c106cf09c1f
                  email: valid@email.com
                  created_at: '2024-06-02T12:31:36.928Z'
                  updated_at: '2024-06-02T12:31:36.928Z'
                  guest: false
                  uid: 
                  provider: 
                redirect_url: "/"
        '422':
          description: user already exist
          content:
            application/json:
              example:
                errors:
                  password_confirmation:
                  - doesn't match Password
                  password:
                  - is too short (minimum is 6 characters)
                  email:
                  - has already been taken
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - email
              - password
              - password_confirmation
              properties:
                email:
                  type: string
                  description: User's email
                password:
                  type: string
                  description: User's password
                password_confirmation:
                  type: string
                  description: password confirmation, should match password
  "/api/v1/resources/":
    parameters:
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: list resources
      operationId: getResources
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
              - id: 0eca764b-0220-4cfd-b823-1132fb1f4973
                space_id: e840e8c1-1b94-4bd5-9b20-9bbb6be6d2ec
                space_key: Wi55btzH
                name: ex.ifc
                current_id: 
                created_at: 2024-06-02 12:31:37 UTC
                updated_at: 2024-06-02 12:31:37 UTC
              - id: f3def1d1-b4c8-4d3f-ac25-5edb99eda1ea
                space_id: e840e8c1-1b94-4bd5-9b20-9bbb6be6d2ec
                space_key: Wi55btzH
                name: dolor.ifc
                current_id: 
                created_at: 2024-06-02 12:31:37 UTC
                updated_at: 2024-06-02 12:31:37 UTC
              - id: a2eee9c3-198b-42c0-a955-32fd1d456456
                space_id: e840e8c1-1b94-4bd5-9b20-9bbb6be6d2ec
                space_key: Wi55btzH
                name: rem.ifc
                current_id: 
                created_at: 2024-06-02 12:31:37 UTC
                updated_at: 2024-06-02 12:31:37 UTC
  "/api/v1/resources/{id}":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: show resource
      operationId: getResource
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: 476ff48e-f84f-4f2c-a130-b4791186498c
                space_id: 11f5f220-20ee-49dc-8381-0f477a33e6d2
                space_key: 3j1uoL0E
                name: totam.ifc
                current_id: 
                created_at: 2024-06-02 12:31:37 UTC
                updated_at: 2024-06-02 12:31:37 UTC
                permissions:
                  manage: true
                  share: true
                share_options:
                  link_access: none
                  space_id: 11f5f220-20ee-49dc-8381-0f477a33e6d2
                  space_key: 3j1uoL0E
                  has_link_password: false
    delete:
      summary: delete resource
      operationId: deleteResource
      responses:
        '204':
          description: successful
  "/api/v1/resources/convert_create":
    parameters:
    - name: space-key
      in: header
      schema:
        type: string
    post:
      summary: convert_create resource
      operationId: convertCreateResource
      description: Create new Resource through conversion, Resource.current version
        is not ready
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                resource:
                  id: b56111ba-5c81-46f7-be85-8ce375e22cad
                  space_id: 49fa39fc-056b-487f-b69b-23d8474e2ecf
                  space_key: fKAaKF7B
                  name: small-model.stp
                  current_id: cced9d4d-1d83-4b1e-92b0-cb88f5cac1d0
                  created_at: '2024-06-02T12:31:37.433Z'
                  updated_at: '2024-06-02T12:31:37.464Z'
                task:
                  id: 3ca41390-4ca1-4f60-9d85-4f594de85435
                  space_id: 49fa39fc-056b-487f-b69b-23d8474e2ecf
                  space_key: fKAaKF7B
                  status: inProgress
                  progress: '0.0'
                  start_time: '2024-06-02T12:31:37.397Z'
                  end_time: 
                  conversion_job_id: 53085f19-3215-4b96-ad03-9c192547d838
                  created_at: '2024-06-02T12:31:37.413Z'
                  updated_at: '2024-06-02T12:31:37.467Z'
                  meta:
                    dest_resource_id: b56111ba-5c81-46f7-be85-8ce375e22cad
                    dest_version_id: cced9d4d-1d83-4b1e-92b0-cb88f5cac1d0
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - input_file
              properties:
                input_file:
                  type: string
                  description: Active Storage signeID
        required: true
  "/api/v1/resources/{id}/convert_update":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    post:
      summary: convert_update resource
      operationId: convertUpdateResource
      description: Create new Version through conversion, Resource.current version
        is not changed
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                version:
                  id: f885e032-d470-4381-869f-96d623ce40b5
                  space_id: dc787b13-1fbb-4392-b31a-d04005de0565
                  space_key: NHjmFCwn
                  resource_id: e21c374f-9e71-4320-a158-8266083c4a3c
                  status: pending
                  is_version: true
                  created_at: '2024-06-02T12:31:37.608Z'
                  updated_at: '2024-06-02T12:31:37.608Z'
                task:
                  id: 4ab4883a-0ecf-4f22-8f5b-fb866714a61a
                  space_id: dc787b13-1fbb-4392-b31a-d04005de0565
                  space_key: NHjmFCwn
                  status: inProgress
                  progress: '0.0'
                  start_time: '2024-06-02T12:31:37.599Z'
                  end_time: 
                  conversion_job_id: d3379efd-213f-4615-b3e9-f4b3cbef9de7
                  created_at: '2024-06-02T12:31:37.601Z'
                  updated_at: '2024-06-02T12:31:37.620Z'
                  meta:
                    dest_resource_id: e21c374f-9e71-4320-a158-8266083c4a3c
                    dest_version_id: f885e032-d470-4381-869f-96d623ce40b5
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - input_file
              properties:
                input_file:
                  type: string
                  description: Active Storage signeID
        required: true
  "/api/v1/resources/{id}/set_current":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    patch:
      summary: set_current resource
      operationId: setResourceCurrent
      description: Change current resource version
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: 79d78ed4-9945-473c-b3e4-331f70c0a632
                space_id: e053404a-2cda-4022-abae-d59811cfd27c
                space_key: PufY2q1t
                name: sint.ifc
                current_id: a5d42456-f555-40a5-9b5b-70f793ed6914
                created_at: 2024-06-02 12:31:37 UTC
                updated_at: 2024-06-02 12:31:37 UTC
                permissions:
                  manage: 
                  share: 
                share_options:
                  link_access: none
                  space_id: e053404a-2cda-4022-abae-d59811cfd27c
                  space_key: PufY2q1t
                  has_link_password: false
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - current_id
              properties:
                current_id:
                  type: string
                  description: New Resource current id, if on one of resource versions
        required: true
  "/users/sign_in":
    post:
      summary: create session
      operationId: signIn
      description: Sign in user
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                user:
                  id: 3d99d894-1a95-4eb9-8367-6845c8c4f617
                  email: jami@beahan.example
                  created_at: '2024-06-02T12:31:37.730Z'
                  updated_at: '2024-06-02T12:31:37.730Z'
                  guest: false
                  uid: 
                  provider: 
                redirect_url: "/"
        '401':
          description: Unauthorized
          content:
            application/json:
              example:
                errors: not authenticated
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - email
              - password
              properties:
                email:
                  type: string
                  description: User's email
                password:
                  type: string
                  description: User's password
  "/api/v1/resources/{id}/share-options":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: show resource's share_options
      operationId: getShareOptions
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                link_access: none
                space_id: b1a9fd15-c198-4aba-a471-a69cd2ec03c9
                space_key: 3CjY2AHu
                has_link_password: false
    patch:
      summary: update resource's share_options
      operationId: updateShareOptions
      parameters: []
      responses:
        '204':
          description: successful
        '422':
          description: unprocessable entity
          content:
            application/json:
              example:
                errors:
                  link_password:
                  - is too short (minimum is 8 characters)
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                link_access:
                  type: string
                  description: Resource view access by link, possible values :none,
                    :view
                  enum:
                  - none
                  - view
                link_password:
                  type: string
                  format: password
        required: true
  "/api/v1/resources/{id}/share-options/auth-password":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    post:
      summary: enter password for resource share_option
      operationId: resourceAuthPassword
      parameters: []
      responses:
        '204':
          description: successful
        '422':
          description: forbidden
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                link_password:
                  type: string
                  format: password
        required: true
  "/api/v1/versions/{id}":
    parameters:
    - name: id
      in: path
      description: Version id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: show version
      operationId: getVersion
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: dad7ae82-f3f2-459b-8005-a03464bfbab6
                space_id: 33a0aaf6-b9a9-4f08-a4d9-6af0da75c74c
                space_key: r5X0F84S
                resource_id: 352173a1-9f9a-4783-962c-ebb47dfefcbd
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
  "/api/v1/versions/{id}/files":
    parameters:
    - name: id
      in: path
      description: Version id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: files version
      operationId: getVersionFiles
      responses:
        '200':
          description: successful
          content:
            application/json:
              example: []
  "/api/v1/resources/{id}/versions":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: get versions
      operationId: getResourceVersions
      description: Resource versions, asset items each of which is versioned representation
        of resource
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
              - id: a6e6a891-31aa-4ffa-b720-9168dd156a51
                space_id: 3ddf7606-77db-45c0-9231-0f16bb64b685
                space_key: hPKP7ebs
                resource_id: 8bd2ec9a-f6b5-4992-ae69-f969b96fd4a0
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: ee9c2a73-4447-47ab-9f74-47bbc9fa4be2
                space_id: 3ddf7606-77db-45c0-9231-0f16bb64b685
                space_key: hPKP7ebs
                resource_id: 8bd2ec9a-f6b5-4992-ae69-f969b96fd4a0
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: e89d5838-6638-470a-a69d-2200b765d7f2
                space_id: 3ddf7606-77db-45c0-9231-0f16bb64b685
                space_key: hPKP7ebs
                resource_id: 8bd2ec9a-f6b5-4992-ae69-f969b96fd4a0
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
  "/api/v1/resources/{id}/asset-items":
    parameters:
    - name: id
      in: path
      description: Version id
      required: true
      schema:
        type: string
    - name: space-key
      in: header
      schema:
        type: string
    get:
      summary: get versions
      operationId: getResourceAssetItems
      description: Resource asset items, not only versions
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
              - id: a6e26b8b-88ea-417e-85fa-96642fdee2f4
                space_id: 7d964890-4246-4387-83c7-636c95947866
                space_key: FtTKuuNR
                resource_id: 8a478556-1f0d-4a35-afdb-5c91e2b06fe5
                status: ready
                is_version: false
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: cda84864-83ba-46a0-8bbc-2ef328786e97
                space_id: 7d964890-4246-4387-83c7-636c95947866
                space_key: FtTKuuNR
                resource_id: 8a478556-1f0d-4a35-afdb-5c91e2b06fe5
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: 77eaa391-07ff-4c0d-b01d-91146ece15d4
                space_id: 7d964890-4246-4387-83c7-636c95947866
                space_key: FtTKuuNR
                resource_id: 8a478556-1f0d-4a35-afdb-5c91e2b06fe5
                status: ready
                is_version: false
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: 23e81b2c-d435-44f1-93fa-a806464642c1
                space_id: 7d964890-4246-4387-83c7-636c95947866
                space_key: FtTKuuNR
                resource_id: 8a478556-1f0d-4a35-afdb-5c91e2b06fe5
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: bb60b11e-49ca-47af-8978-762baa56f67d
                space_id: 7d964890-4246-4387-83c7-636c95947866
                space_key: FtTKuuNR
                resource_id: 8a478556-1f0d-4a35-afdb-5c91e2b06fe5
                status: ready
                is_version: false
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
              - id: 9e2e42a0-f28f-4738-9589-3c7ee483b1fe
                space_id: 7d964890-4246-4387-83c7-636c95947866
                space_key: FtTKuuNR
                resource_id: 8a478556-1f0d-4a35-afdb-5c91e2b06fe5
                status: ready
                is_version: true
                created_at: 2024-06-02 12:31:38 UTC
                updated_at: 2024-06-02 12:31:38 UTC
components:
  schemas:
    conversion_task:
      type: object
      properties:
        status:
          type: string
          example: finished
        progress:
          type: string
        start_time:
          type: string
          format: date_time
          nullable: true
        end_time:
          type: string
          format: date_time
          nullable: true
        conversion_job_id:
          type: string
          nullable: true
        created_at:
          type: string
          format: date_time
        updated_at:
          type: string
          format: date_time
        meta:
          type: object
          properties:
            dest_resource_id:
              type: string
              nullable: true
            dest_version_id:
              type: string
              nullable: true
servers:
- url: http://{defaultHost}
  variables:
    defaultHost:
      default: localhost:3050
