---
openapi: 3.0.1
info:
  title: API V1
  version: v1
paths:
  "/api/v1/conversions":
    get:
      summary: List conversions
      operationId: getConversions
      description: List conversion tasks for user
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
              - id: 925bc808-8e38-4848-a674-dc067a9a9858
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T13:25:39.593Z'
                end_time: 
                conversion_job_id: bb7a4431-3153-4ed7-a6d2-17b018bf17ca
                created_at: '2024-02-22T13:25:39.594Z'
                updated_at: '2024-02-22T13:25:39.594Z'
                meta:
                  dest_resource_id: 5c3cd848-8ba8-4e25-b34b-bee98effec0d
                  dest_version_id: dc52869f-3d67-4adc-aa2a-2644408d4f28
                cs_server: local
              - id: fced0b3e-9e70-47fa-9b18-d23eddd29a64
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T13:25:39.597Z'
                end_time: 
                conversion_job_id: 0a7ed4ab-480c-4223-9d12-97f6ca48c54e
                created_at: '2024-02-22T13:25:39.597Z'
                updated_at: '2024-02-22T13:25:39.597Z'
                meta:
                  dest_resource_id: c3db7e15-27ea-49c2-a6d0-63921d6f7194
                  dest_version_id: 4a7c5f42-50f7-4ffe-9f5a-0edf850fb946
                cs_server: local
              schema:
                type: array
                items:
                  "$ref": "#/components/schemas/conversion_task"
  "/api/v1/conversions/{id}":
    parameters:
    - name: id
      in: path
      description: id
      required: true
      schema:
        type: string
    get:
      summary: show conversion
      operationId: getConversion
      description: Get description of Conversion Task
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: 5b6908a4-7a16-4bcd-b308-314d4160f180
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T13:25:39.623Z'
                end_time: 
                conversion_job_id: b3f51694-99a8-4b1e-822f-a822b874a031
                created_at: '2024-02-22T13:25:39.623Z'
                updated_at: '2024-02-22T13:25:39.623Z'
                meta:
                  dest_resource_id: c4815b36-bc1f-4f12-bbd3-c1f51b16ae58
                  dest_version_id: 50cd6df9-075c-4ec9-b115-37f4e16fe040
                cs_server: local
              schema:
                "$ref": "#/components/schemas/conversion_task"
  "/api/v1/conversions/{id}/logs":
    parameters:
    - name: id
      in: path
      description: Conversion Task id
      required: true
      schema:
        type: string
    get:
      summary: logs conversion
      operationId: getConversionLogs
      description: Get logs of Conversion Task (redirect to logs file)
      responses:
        '302':
          description: successful
  "/api/v1/op/convert-anonym":
    post:
      summary: convert_anonym op
      operationId: convertAnonym
      description: Start anonym conversion
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: 923df51c-3192-4cee-96f6-547a4c5c41ba
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T13:25:39.758Z'
                end_time: 
                conversion_job_id: 5061ddc8-83d7-44bd-b832-0b781531de9b
                created_at: '2024-02-22T13:25:39.758Z'
                updated_at: '2024-02-22T13:25:39.769Z'
                meta:
                  dest_resource_id: a81a4259-d1fd-4a0c-ab87-89cabeca85dd
                  dest_version_id: 2f11b050-2e7c-43f5-8fae-69f4dcada229
                cs_server: local
              schema:
                "$ref": "#/components/schemas/conversion_task"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - input_file
              properties:
                input_file:
                  type: string
                  description: Active Storage signeID
  "/api/v1/resources/{id}/share-options":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    patch:
      summary: update resource's share_options
      operationId: updateShareOptions
      parameters: []
      responses:
        '204':
          description: successful
        '422':
          description: unprocessable entity
          content:
            application/json:
              example:
                errors:
                  link_password:
                  - is too short (minimum is 8 characters)
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                link_access:
                  type: string
                  description: Resource view access by link, possible values :none,
                    :view
                  enum:
                  - none
                  - view
                link_password:
                  type: string
                  format: password
  "/api/v1/resources/{id}/share-options/auth-password":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    post:
      summary: enter password for resource share_option
      operationId: resourceAuthPassword
      parameters: []
      responses:
        '204':
          description: successful
        '403':
          description: forbidden
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                link_password:
                  type: string
                  format: password
components:
  schemas:
    conversion_task:
      type: object
      properties:
        status:
          type: string
          example: finished
        progress:
          type: string
        start_time:
          type: string
          format: date_time
          nullable: true
        end_time:
          type: string
          format: date_time
          nullable: true
        conversion_job_id:
          type: string
          nullable: true
        created_at:
          type: string
          format: date_time
        updated_at:
          type: string
          format: date_time
        meta:
          type: object
          properties:
            dest_resource_id:
              type: string
              nullable: true
            dest_version_id:
              type: string
              nullable: true
servers:
- url: http://{defaultHost}
  variables:
    defaultHost:
      default: localhost:3050
