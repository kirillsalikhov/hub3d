---
openapi: 3.0.1
info:
  title: API V1
  version: v1
paths:
  "/api/v1/conversions":
    get:
      summary: List conversions
      operationId: getConversions
      description: List conversion tasks for user
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
              - id: 6b6bff96-f3c0-4360-afcc-9dc0832d68ec
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T12:58:12.268Z'
                end_time: 
                conversion_job_id: 9411c215-f087-4261-96ec-57317de9e77a
                created_at: '2024-02-22T12:58:12.269Z'
                updated_at: '2024-02-22T12:58:12.269Z'
                meta:
                  dest_resource_id: ad5641ad-2fba-4744-bed8-5545f4365780
                  dest_version_id: b3e9e6b6-5d8c-4d2b-bc80-f8e40acc4d60
                cs_server: local
              - id: 70ac9903-cb29-456e-800f-c877122594d5
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T12:58:12.273Z'
                end_time: 
                conversion_job_id: b874f7e9-2a69-4744-948b-70025b5f401d
                created_at: '2024-02-22T12:58:12.273Z'
                updated_at: '2024-02-22T12:58:12.273Z'
                meta:
                  dest_resource_id: e2384dcb-c76c-4594-bdc7-5c4fb92db263
                  dest_version_id: d39e5dcc-0dcc-4285-b844-889cd9c88002
                cs_server: local
              schema:
                type: array
                items:
                  "$ref": "#/components/schemas/conversion_task"
  "/api/v1/conversions/{id}":
    parameters:
    - name: id
      in: path
      description: id
      required: true
      schema:
        type: string
    get:
      summary: show conversion
      operationId: getConversion
      description: Get description of Conversion Task
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: a68d40b9-e68c-4d0b-a479-be59b343077d
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T12:58:12.331Z'
                end_time: 
                conversion_job_id: 251d07fb-8392-4803-975f-2eb73e8a6c84
                created_at: '2024-02-22T12:58:12.331Z'
                updated_at: '2024-02-22T12:58:12.331Z'
                meta:
                  dest_resource_id: 8673d4a6-e0ea-46cb-a3d8-6dc70919cdc0
                  dest_version_id: ec4908f4-eaac-4a3f-86fb-08a3410413e7
                cs_server: local
              schema:
                "$ref": "#/components/schemas/conversion_task"
  "/api/v1/conversions/{id}/logs":
    parameters:
    - name: id
      in: path
      description: Conversion Task id
      required: true
      schema:
        type: string
    get:
      summary: logs conversion
      operationId: getConversionLogs
      description: Get logs of Conversion Task (redirect to logs file)
      responses:
        '302':
          description: successful
  "/api/v1/op/convert-anonym":
    post:
      summary: convert_anonym op
      operationId: convertAnonym
      description: Start anonym conversion
      parameters: []
      responses:
        '200':
          description: successful
          content:
            application/json:
              example:
                id: db72b467-396d-4160-9c0f-d783f115287e
                status: inProgress
                progress: '0.0'
                start_time: '2024-02-22T12:58:13.992Z'
                end_time: 
                conversion_job_id: ca1812b5-1c7f-4a17-bf88-92f1d3f4c9a5
                created_at: '2024-02-22T12:58:13.992Z'
                updated_at: '2024-02-22T12:58:14.005Z'
                meta:
                  dest_resource_id: ebd864cc-8275-4c63-995f-c1e7557fb8ce
                  dest_version_id: d60904f0-9cea-4b5a-af8f-2781668183d8
                cs_server: local
              schema:
                "$ref": "#/components/schemas/conversion_task"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - input_file
              properties:
                input_file:
                  type: string
                  description: Active Storage signeID
  "/api/v1/resources/{id}/share-options":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    patch:
      summary: update resource's share_options
      operationId: updateShareOptions
      parameters: []
      responses:
        '204':
          description: successful
        '422':
          description: unprocessable entity
          content:
            application/json:
              example:
                errors:
                  link_password:
                  - is too short (minimum is 8 characters)
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                link_access:
                  type: string
                  description: Resource view access by link, possible values :none,
                    :view
                  enum:
                  - none
                  - view
                link_password:
                  type: string
                  format: password
  "/api/v1/resources/{id}/share-options/auth-password":
    parameters:
    - name: id
      in: path
      description: Resource id
      required: true
      schema:
        type: string
    post:
      summary: enter password for resource share_option
      operationId: resourceAuthPassword
      parameters: []
      responses:
        '204':
          description: successful
        '403':
          description: forbidden
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                link_password:
                  type: string
                  format: password
components:
  schemas:
    conversion_task:
      type: object
      properties:
        status:
          type: string
          example: finished
        progress:
          type: string
        start_time:
          type: string
          format: date_time
          nullable: true
        end_time:
          type: string
          format: date_time
          nullable: true
        conversion_job_id:
          type: string
          nullable: true
        created_at:
          type: string
          format: date_time
        updated_at:
          type: string
          format: date_time
        meta:
          type: object
          properties:
            dest_resource_id:
              type: string
              nullable: true
            dest_version_id:
              type: string
              nullable: true
servers:
- url: http://{defaultHost}
  variables:
    defaultHost:
      default: localhost:3050
